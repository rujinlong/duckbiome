% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils_vir.R
\name{parse_vibrant_quality}
\alias{parse_vibrant_quality}
\title{Parse VIBRANT Quality Score File}
\usage{
parse_vibrant_quality(fin_vibrant_quality)
}
\arguments{
\item{fin_vibrant_quality}{A character string specifying the path to
the VIBRANT quality score file.}
}
\value{
A data frame containing the contig ID, quality score, and type
  for each contig. Quality scores are re-encoded as numeric values:
  * 1: complete circular
  * 2: high quality draft
  * 3: medium quality draft
  * 4: low quality draft
  * 9: other (catch-all for unclassified types)
}
\description{
This function parses a VIBRANT quality score file to extract the quality
score and type (lytic or lysogenic) for each contig. It handles common
issues in the VIBRANT output, such as duplicate entries and inconsistent
classifications. Contig IDs are extracted from scaffold names by removing
the "_fragment_*" suffix.
}
\details{
The function performs the following steps:
\enumerate{
  \item Reads the VIBRANT quality score file.
  \item Extracts the contig ID from scaffold names.
  \item Re-encodes the quality score as a numeric value.
  \item Separates provirus and non-provirus entries.
  \item Resolves duplicate entries, prioritizing non-provirus entries
        and higher quality scores.
  \item Combines the provirus and non-provirus data.
  \item Renames columns to include the "vibrant_" prefix for clarity.
}
}
\examples{
\dontrun{
# Example usage:
# Assuming 'vibrant_quality.tsv' is the VIBRANT quality file
df_quality <- parse_vibrant_quality("vibrant_quality.tsv")
}
}
